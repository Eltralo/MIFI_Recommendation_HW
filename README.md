# Прототип книжного рекомендательного сервиса (Goodbooks-10k)

Сравнительный анализ рекомендательных систем на основе датасета Goodbooks-10k.

## Задача проекта

Создание и сравнительный анализ прототипа рекомендательной системы на датасете Goodbooks-10k. Цель — реализовать и оценить различные подходы к рекомендациям:

- Popularity (неперсонализированный бейзлайн)
- Content-Based Filtering
- Item-Based Collaborative Filtering
- Matrix Factorization (SVD)

для определения наиболее эффективной стратегии персонализированных рекомендаций книг.

## Данные

Используется датасет Goodbooks-10k, содержащий:

- Около 5.9 млн оценок
- Около 10 000 уникальных книг


## Этапы реализации

### Этап 1: EDA (Разведочный анализ данных)

Выявлены ключевые проблемы:

- Смещение популярности: большинство оценок приходится на ТОП-книги («длинный хвост»).
- Разреженность: матрица пользователь–книга крайне разрежена.
- Холодный старт: много пользователей с 1–5 оценками.
- Качество тегов: присутствуют поведенческие теги (например, "to-read"), что снижает качество контентной векторизации.

### Этап 2: Базовые и контентные модели

- **Model 1: Popularity**  
  Возвращает Top-N самых популярных книг (бейзлайн без персонализации).

- **Model 2: Content-Based**  
  - Использованы название книги и теги.  
  - Векторизация: TF-IDF.  
  - Схожесть: косинусное расстояние.  
  - Рекомендации основаны на схожести профилей книг.

### Этап 3: Коллаборативная фильтрация (CF)

- **Model 3: Item-Based Collaborative Filtering**  
  - Классический подход на основе схожести книг по оценкам пользователей.  
  - Высокая вычислительная сложность (матрица N×N).  
  - Оптимизация: использование разреженных матриц и предварительный отбор данных.

### Этап 4: Матричные разложения

- **Model 4: SVD (Singular Value Decomposition)**  
  - Реализовано с помощью библиотеки surprise.  
  - Обучение и валидация по метрике RMSE.  
  - Для ускорения оценки Top-K метрик применены:  
    - User Sampling  
    - Item Sampling (ограничение каталога до ТОП-2000 книг)

### Этап 5: Оценка и сравнение моделей

Все модели оценены на отложенной тестовой выборке по следующим метрикам:

- Precision@K
- Recall@K
- nDCG@K

Результаты (K = 10):

| Модель                     | nDCG@10 | Precision@10 |
|---------------------------|---------|--------------|
| Popularity                | 0.0321  | 0.0285       |
| Content-Based             | 0.0587  | 0.0512       |
| Item-Based CF             | 0.0934  | 0.0821       |
| SVD (Matrix Factorization)| 0.1200  | 0.1065       |

SVD показала наилучшее качество ранжирования, подтвердив преимущество персонализированных подходов.

## Выводы и рекомендации

### Лучшая модель
SVD (Matrix Factorization) — лучшая по метрикам nDCG и Precision, эффективно справляется с разреженностью данных.

### Стратегия гибридизации (для продакшена)
Рекомендуется использовать Switching Hybrid подход:

- Новые пользователи / новые книги: Content-Based или Popularity
- Опытные пользователи: SVD

### Дальнейшие улучшения
- Внедрение SVD++ для учёта неявных взаимодействий.
- Использование BERT-эмбеддингов для улучшения контентной модели (векторизация названий и описаний).
- Эксперименты с нейросетевыми рекомендательными системами (NeuMF, LightGCN).

Проект демонстрирует, что даже на относительно небольшом датасете (10k книг) матричные разложения дают значимый прирост качества рекомендаций по сравнению с простыми и контентными моделями.
